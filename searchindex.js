Search.setIndex({"docnames": ["api/sketchyopts.errors", "api/sketchyopts.preconditioner", "api/sketchyopts.solver", "api/sketchyopts.util", "index"], "filenames": ["api/sketchyopts.errors.rst", "api/sketchyopts.preconditioner.rst", "api/sketchyopts.solver.rst", "api/sketchyopts.util.rst", "index.rst"], "titles": ["Error Messages", "Preconditioners", "Solvers", "Utilities", "SketchyOpts"], "terms": {"thi": [0, 1, 3, 4], "page": 0, "provid": [0, 1, 3, 4], "more": 0, "detail": 0, "inform": [0, 3], "some": 0, "one": [0, 3], "might": 0, "encount": 0, "when": [0, 1, 2, 3], "us": [0, 1, 2, 3, 4], "librari": [0, 4], "we": [0, 4], "also": [0, 3], "try": [0, 3], "offer": 0, "guidanc": 0, "how": 0, "potenti": 0, "resolv": 0, "issu": 0, "class": [0, 1, 3], "sketchyopt": [0, 1, 2, 3], "inputdimerror": 0, "input_nam": 0, "actual_dim": 0, "required_dim": 0, "sourc": [0, 1, 2, 3], "incorrect": 0, "dimens": [0, 3], "occur": 0, "an": [0, 1, 2, 3], "argument": [0, 1, 2, 3], "function": [0, 1, 2, 3], "ha": [0, 2, 3], "unexpect": 0, "matrixnotsquareerror": 0, "actual_shap": 0, "non": [0, 1, 2], "squar": 0, "matrix": [0, 1, 2, 3], "repres": [0, 1, 2, 3], "get": [0, 2, 3], "pass": [0, 3], "expect": 0, "rand_nystrom_approx": 1, "A": [1, 2, 3], "l": [1, 2], "kei": [1, 2, 3], "posit": [1, 2], "semidefinit": [1, 2], "The": [1, 2, 3, 4], "comput": [1, 3], "rank": [1, 2], "given": [1, 3], "r": [1, 2], "n": 1, "time": [1, 2], "It": [1, 2], "return": [1, 2, 3], "truncat": 1, "eigen": 1, "decomposit": 1, "hat": [1, 2], "_": [1, 2], "mathrm": 1, "ny": 1, "u": [1, 2], "lambda": [1, 2], "t": [1, 2], "where": [1, 2], "i": [1, 2, 3, 4], "orthonorm": 1, "consist": 1, "eigenvector": 1, "column": 1, "diagon": [1, 2], "eigenvalu": 1, "its": [1, 2, 3], "note": [1, 3], "output": 1, "wherea": 1, "": [1, 2], "contain": [1, 2, 3], "onli": [1, 2, 3], "full": 1, "refer": [1, 2, 4], "h": 1, "li": 1, "g": [1, 2, 3], "c": 1, "linderman": 1, "szlam": 1, "k": [1, 2], "p": [1, 2], "stanton": 1, "y": 1, "kluger": 1, "m": [1, 2], "tygert": 1, "algorithm": [1, 2], "971": 1, "implement": [1, 3, 4], "princip": 1, "compon": 1, "analysi": [1, 2], "acm": 1, "transact": 1, "mathemat": 1, "softwar": 1, "tom": 1, "43": 1, "2017": 1, "pp": [1, 2], "1": [1, 2], "14": [1, 2], "j": [1, 2], "tropp": [1, 2], "yurtsev": 1, "udel": [1, 2], "v": 1, "cevher": 1, "fix": [1, 2], "from": [1, 2, 3], "stream": 1, "data": 1, "nip": 1, "vol": [1, 2], "30": 1, "1225": 1, "1234": 1, "paramet": [1, 2, 3], "union": [1, 2, 3], "arrai": [1, 2, 3], "ndarrai": [1, 2, 3], "bool_": [1, 2, 3], "number": [1, 2, 3], "bool": [1, 2, 3], "int": [1, 2, 3], "float": [1, 2, 3], "complex": [1, 2, 3], "linearoper": [1, 3], "two": [1, 2, 3], "dimension": [1, 2], "can": [1, 2, 3, 4], "either": [1, 2, 3], "explicit": [1, 3], "jax": [1, 2, 3, 4], "implicit": 1, "util": 1, "object": [1, 2, 3], "which": [1, 2], "coincid": [1, 2], "sketch": [1, 2, 4], "size": [1, 2], "prng": [1, 2], "type": [1, 2], "tupl": [1, 2, 3], "element": [1, 2], "entri": [1, 2], "nystromprecondst": 1, "step_count": 1, "learning_r": [1, 2, 3], "none": [1, 2, 3], "state": 1, "updat": [1, 2, 3], "learn": [1, 2, 3], "rate": [1, 2, 3], "pick": 1, "step": [1, 2, 3], "count": [1, 2], "execut": 1, "iter": [1, 2, 3], "update_nystrom_precond": 1, "rho": [1, 2], "update_freq": [1, 2], "seed": [1, 2], "f": [1, 2], "adaptive_lr": 1, "true": [1, 3], "low": [1, 2], "subsampl": [1, 2], "hessian": [1, 2], "determin": 1, "appropri": [1, 2], "power": 1, "set": [1, 2, 3], "z": [1, 2], "frangella": [1, 2], "rathor": [1, 2], "zhao": [1, 2], "sketchysgd": 1, "reliabl": [1, 2], "stochast": [1, 2], "optim": [1, 2, 4], "via": [1, 2, 3], "curvatur": [1, 2], "estim": [1, 2], "regular": [1, 2], "neg": [1, 2, 3], "valu": [1, 2, 3], "integ": [1, 2], "specifi": [1, 2, 3], "frequenc": [1, 2], "0": [1, 2, 3], "infti": [1, 2], "e": [1, 2, 3], "numpi": [1, 2], "inf": [1, 2], "constant": [1, 2], "construct": [1, 2], "begin": [1, 2], "process": [1, 2], "gener": [1, 2], "callabl": [1, 2, 3], "concaten": [1, 2], "paramspec": [1, 2], "bound": [1, 2], "scalar": [1, 2, 3], "loss": [1, 2, 3], "need": [1, 2, 3], "have": [1, 2], "variabl": [1, 2, 3], "first": [1, 2], "whether": [1, 2, 3], "enabl": 1, "autom": 1, "select": [1, 2], "default": [1, 2, 3], "adapt": [1, 2, 3], "choos": [1, 2], "whenev": [1, 2], "2": [1, 2], "referenc": [1, 3], "paper": 1, "gradienttransformationextraarg": [1, 3], "scale_by_nystrom_precond": 1, "ref_stat": [1, 3], "rescal": 1, "scale": [1, 3], "gradient": [1, 2, 3], "specif": [1, 3], "appli": [1, 2], "invers": 1, "lemma": 1, "follow": [1, 3, 4], "equat": 1, "3": [1, 2, 3], "frac": 1, "obtain": 1, "direct": 1, "If": 1, "eigendecomposit": 1, "directli": 1, "ar": [1, 2, 3], "store": 1, "option": [1, 2, 3], "str": [1, 3], "name": [1, 3], "chain": [1, 3], "nystrom_pcg": 2, "b": 2, "mu": 2, "x0": 2, "tol": 2, "1e": 2, "05": 2, "maxit": 2, "precondit": 2, "conjug": 2, "method": [2, 4], "solv": 2, "linear": 2, "system": 2, "x": 2, "random": 2, "precondition": 2, "implicitli": 2, "approxim": 2, "here": 2, "th": 2, "termin": 2, "ell_2": 2, "norm": 2, "residu": 2, "within": [2, 3], "toler": 2, "reach": 2, "maxim": 2, "siam": 2, "journal": 2, "applic": 2, "44": 2, "iss": 2, "2023": 2, "718": 2, "752": 2, "vector": [2, 3], "give": 2, "righthand": 2, "side": 2, "initi": [2, 3], "guess": 2, "solut": [2, 4], "same": 2, "zero": 2, "start": 2, "10": 2, "5": 2, "maximum": 2, "been": 2, "achiev": 2, "intern": 2, "ten": 2, "four": 2, "statu": 2, "converg": 2, "each": [2, 3], "total": 2, "quasi": 2, "newton": 2, "maintain": 2, "sgd": 2, "automat": 2, "exampl": [2, 3], "import": 2, "optax": [2, 3, 4], "jnp": 2, "def": [2, 3], "sum": 2, "simpl": 2, "quadrat": 2, "param": [2, 3], "print": 2, "opt_stat": [2, 3], "init": [2, 3], "rang": 2, "grad": [2, 3], "apply_upd": 2, "2e": 2, "format": 2, "63e": 2, "12": 2, "6": 2, "37e": 2, "25": 2, "75e": 2, "37": 2, "00e": 2, "00": 2, "schedul": [2, 3], "base": [2, 3, 4], "gradienttransform": [2, 3], "correspond": [2, 3], "shape": 3, "ndim": 3, "interfac": 3, "abstract": 3, "__init__": 3, "__matmul__": 3, "other": 3, "alia": 3, "matmul": 3, "overwrit": 3, "product": [3, 4], "between": 3, "match": 3, "result": 3, "transformupdateextraargsrefstatefn": 3, "arg": 3, "kwarg": 3, "accept": 3, "addit": 3, "keyword": 3, "__call__": 3, "chain_stat": 3, "extra_arg": 3, "extra": 3, "For": 3, "requir": 3, "reli": 3, "preced": 3, "could": 3, "express": 3, "del": 3, "access": [3, 4], "tx_name": 3, "signatur": 3, "impli": 3, "user": 3, "error": 3, "thei": 3, "without": 3, "arraytre": 3, "map": 3, "ani": 3, "associ": 3, "dict": 3, "dictionari": 3, "all": 3, "implementor": 3, "should": 3, "arbitrari": 3, "ignor": 3, "those": 3, "current": 3, "gradienttransformationextraargsrefst": 3, "transforminitfn": 3, "transformupdatefn": 3, "special": 3, "support": 3, "extend": 3, "exist": 3, "ad": 3, "By": 3, "convert": 3, "Such": 3, "realiz": 3, "with_ref_state_support": 3, "overrid": 3, "tx": 3, "wrap": 3, "so": 3, "take": 3, "analog": 3, "with_extra_args_support": 3, "main": 3, "instanc": 3, "allow": 3, "shareble_state_named_chain": 3, "work": 3, "compat": 3, "length": 3, "previous": 3, "preserv": 3, "share": 3, "named_chain": 3, "make": 3, "avail": 3, "succeed": 3, "visibl": 3, "third": 3, "allowstransform": 3, "proceed": 3, "put": 3, "togeth": 3, "complet": 3, "sequenti": 3, "call": 3, "mean": 3, "must": 3, "origin": 3, "docstr": 3, "below": 3, "pair": 3, "constitut": 3, "string": 3, "thu": 3, "retriev": 3, "tx1": 3, "tx2": 3, "tx3": 3, "temperatur": 3, "done": 3, "instanti": 3, "depend": 3, "transform_fn_nam": 3, "some_arg": 3, "three": 3, "01": 3, "latter": 3, "scale_by_ref_learning_r": 3, "flip_sign": 3, "scale_by_learning_r": 3, "defin": 3, "flip": 3, "sign": 3, "primari": 4, "goal": 4, "effici": 4, "scientif": 4, "commun": 4, "To": 4, "end": 4, "design": 4, "philosophi": 4, "structur": 4, "compos": 4, "block": 4, "hope": 4, "facilit": 4, "research": 4, "lead": 4, "new": 4, "idea": 4, "excit": 4, "latest": 4, "releas": 4, "pip": 4, "tutori": 4, "benchmark": 4, "api": 4}, "objects": {"sketchyopts.errors": [[0, 0, 1, "", "InputDimError"], [0, 0, 1, "", "MatrixNotSquareError"]], "sketchyopts.preconditioner": [[1, 0, 1, "", "NystromPrecondState"], [1, 2, 1, "", "rand_nystrom_approx"], [1, 2, 1, "", "scale_by_nystrom_precond"], [1, 2, 1, "", "update_nystrom_precond"]], "sketchyopts.preconditioner.NystromPrecondState": [[1, 1, 1, "", "S"], [1, 1, 1, "", "U"], [1, 1, 1, "", "key"], [1, 1, 1, "", "learning_rate"], [1, 1, 1, "", "step_count"]], "sketchyopts.solver": [[2, 2, 1, "", "nystrom_pcg"], [2, 2, 1, "", "sketchysgd"]], "sketchyopts.util": [[3, 0, 1, "", "GradientTransformationExtraArgsRefState"], [3, 0, 1, "", "LinearOperator"], [3, 0, 1, "", "TransformUpdateExtraArgsRefStateFn"], [3, 2, 1, "", "scale_by_ref_learning_rate"], [3, 2, 1, "", "shareble_state_named_chain"], [3, 2, 1, "", "with_ref_state_support"]], "sketchyopts.util.GradientTransformationExtraArgsRefState": [[3, 1, 1, "", "update"]], "sketchyopts.util.LinearOperator": [[3, 3, 1, "", "__init__"], [3, 3, 1, "", "__matmul__"], [3, 3, 1, "", "matmul"]], "sketchyopts.util.TransformUpdateExtraArgsRefStateFn": [[3, 3, 1, "", "__call__"]]}, "objtypes": {"0": "py:class", "1": "py:attribute", "2": "py:function", "3": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "attribute", "Python attribute"], "2": ["py", "function", "Python function"], "3": ["py", "method", "Python method"]}, "titleterms": {"error": 0, "messag": 0, "input": 0, "precondition": 1, "random": 1, "nystr\u00f6m": [1, 2], "approxim": 1, "solver": 2, "pcg": 2, "sketchysgd": 2, "util": 3, "linear": 3, "oper": 3, "transform": 3, "type": 3, "convers": 3, "sharabl": 3, "state": 3, "sketchyopt": 4, "instal": 4, "quick": 4, "exampl": 4, "citat": 4}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 60}, "alltitles": {"Error Messages": [[0, "error-messages"]], "Input Errors": [[0, "input-errors"]], "Preconditioners": [[1, "preconditioners"]], "Randomized Nystr\u00f6m Approximation": [[1, "randomized-nystrom-approximation"]], "Nystr\u00f6m Preconditioner": [[1, "nystrom-preconditioner"]], "Solvers": [[2, "solvers"]], "Nystr\u00f6m PCG": [[2, "nystrom-pcg"]], "SketchySGD": [[2, "sketchysgd"]], "Utilities": [[3, "utilities"]], "Linear Operator": [[3, "linear-operator"]], "Transformations": [[3, "transformations"]], "Type": [[3, "type"]], "Type Conversion": [[3, "type-conversion"]], "Sharable State Transformations": [[3, "sharable-state-transformations"]], "SketchyOpts": [[4, "sketchyopts"]], "Installation": [[4, "installation"]], "Quick Example": [[4, "quick-example"]], "Citation": [[4, "citation"]]}, "indexentries": {"inputdimerror (class in sketchyopts.errors)": [[0, "sketchyopts.errors.InputDimError"]], "matrixnotsquareerror (class in sketchyopts.errors)": [[0, "sketchyopts.errors.MatrixNotSquareError"]], "nystromprecondstate (class in sketchyopts.preconditioner)": [[1, "sketchyopts.preconditioner.NystromPrecondState"]], "s (sketchyopts.preconditioner.nystromprecondstate attribute)": [[1, "sketchyopts.preconditioner.NystromPrecondState.S"]], "u (sketchyopts.preconditioner.nystromprecondstate attribute)": [[1, "sketchyopts.preconditioner.NystromPrecondState.U"]], "key (sketchyopts.preconditioner.nystromprecondstate attribute)": [[1, "sketchyopts.preconditioner.NystromPrecondState.key"]], "learning_rate (sketchyopts.preconditioner.nystromprecondstate attribute)": [[1, "sketchyopts.preconditioner.NystromPrecondState.learning_rate"]], "rand_nystrom_approx() (in module sketchyopts.preconditioner)": [[1, "sketchyopts.preconditioner.rand_nystrom_approx"]], "scale_by_nystrom_precond() (in module sketchyopts.preconditioner)": [[1, "sketchyopts.preconditioner.scale_by_nystrom_precond"]], "step_count (sketchyopts.preconditioner.nystromprecondstate attribute)": [[1, "sketchyopts.preconditioner.NystromPrecondState.step_count"]], "update_nystrom_precond() (in module sketchyopts.preconditioner)": [[1, "sketchyopts.preconditioner.update_nystrom_precond"]], "nystrom_pcg() (in module sketchyopts.solver)": [[2, "sketchyopts.solver.nystrom_pcg"]], "sketchysgd() (in module sketchyopts.solver)": [[2, "sketchyopts.solver.sketchysgd"]], "gradienttransformationextraargsrefstate (class in sketchyopts.util)": [[3, "sketchyopts.util.GradientTransformationExtraArgsRefState"]], "linearoperator (class in sketchyopts.util)": [[3, "sketchyopts.util.LinearOperator"]], "transformupdateextraargsrefstatefn (class in sketchyopts.util)": [[3, "sketchyopts.util.TransformUpdateExtraArgsRefStateFn"]], "__call__() (sketchyopts.util.transformupdateextraargsrefstatefn method)": [[3, "sketchyopts.util.TransformUpdateExtraArgsRefStateFn.__call__"]], "__init__() (sketchyopts.util.linearoperator method)": [[3, "sketchyopts.util.LinearOperator.__init__"]], "__matmul__() (sketchyopts.util.linearoperator method)": [[3, "sketchyopts.util.LinearOperator.__matmul__"]], "matmul() (sketchyopts.util.linearoperator method)": [[3, "sketchyopts.util.LinearOperator.matmul"]], "scale_by_ref_learning_rate() (in module sketchyopts.util)": [[3, "sketchyopts.util.scale_by_ref_learning_rate"]], "shareble_state_named_chain() (in module sketchyopts.util)": [[3, "sketchyopts.util.shareble_state_named_chain"]], "update (sketchyopts.util.gradienttransformationextraargsrefstate attribute)": [[3, "sketchyopts.util.GradientTransformationExtraArgsRefState.update"]], "with_ref_state_support() (in module sketchyopts.util)": [[3, "sketchyopts.util.with_ref_state_support"]]}})